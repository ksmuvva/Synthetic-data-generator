# ğŸ”„ BDD Conversion Example

This directory contains a complete example showing how to convert a Playwright recording to proper BDD (Behavior-Driven Development) format.

## ğŸ“ Files in This Directory

| File | Description |
|------|-------------|
| `herokuapp_test-dample_2025-11-23.py` | **Original Playwright recording** - Raw script generated by Playwright codegen |
| `herokuapp_test-dample_2025-11-23.feature` | **Converted BDD feature file** - Proper Gherkin scenarios extracted from recording |
| `herokuapp_test_steps.py` | **Step definitions** - Python implementations of the Gherkin steps |
| `environment.py` | **Behave hooks** - Setup/teardown and context initialization |
| `README.md` | This file - Guide to using these examples |

## ğŸ¯ What This Example Demonstrates

### Issue #1: Wrong File Location âŒ

```
project/
â”œâ”€â”€ steps/
â”‚   â””â”€â”€ environment.py          â† WRONG! Behave won't find it
â””â”€â”€ features/
    â””â”€â”€ test.feature
```

**Problem**: Behave looks for `environment.py` in `features/`, not `steps/`
**Result**: Hooks don't run â†’ `context.page` is never created â†’ AttributeError

### Issue #2: Missing BDD Conversion âŒ

```python
# Raw Playwright recording (not BDD)
page.goto("https://example.com")
page.click("text=Checkboxes")
checkbox1.check()
```

**Problem**: Recording is raw code, not human-readable scenarios
**Result**: Hard to maintain, not reusable, unclear test intent

## âœ… How This Example Fixes Both Issues

### Fix #1: Correct File Structure

This example shows the **correct** structure:

```
features/                              â† Feature directory
â”œâ”€â”€ environment.py                    âœ… Correct location!
â”œâ”€â”€ steps/
â”‚   â””â”€â”€ herokuapp_test_steps.py       âœ… Step definitions here
â””â”€â”€ herokuapp_test-dample_2025-11-23.feature
```

**Result**: Behave finds environment.py â†’ Hooks run â†’ context.page is created

### Fix #2: Proper BDD Conversion

| Before (Recording) | After (BDD) |
|-------------------|-------------|
| `page.goto("https://...")` | `Given I navigate to the Herokuapp homepage` |
| `page.click("text=Checkboxes")` | `When I click on the "Checkboxes" link` |
| `checkbox1.check()` | `When I check the first checkbox` |
| `checkbox2.uncheck()` | `When I uncheck the second checkbox` |

**Result**: Human-readable, reusable, maintainable tests

## ğŸš€ How to Use These Examples

### Step 1: Install Dependencies

```bash
pip install behave playwright
playwright install chromium
```

### Step 2: Set Up Correct Structure

If you're using these examples in your own project:

```bash
# Create the correct directory structure
mkdir -p features/steps

# Copy files to correct locations
cp environment.py features/
cp herokuapp_test_steps.py features/steps/
cp herokuapp_test-dample_2025-11-23.feature features/
```

### Step 3: Run the Original Recording (Optional)

To see what the raw recording does:

```bash
python herokuapp_test-dample_2025-11-23.py
```

### Step 4: Run the BDD Tests

```bash
# Run all scenarios
behave features/

# Run specific scenarios by tag
behave --tags=@smoke
behave --tags=@checkboxes
behave --tags=@challenging-dom

# Run with verbose output
behave -v features/
```

### Step 5: Verify Hooks Are Working

When you run the tests, you should see:

```
ğŸš€ Initializing test framework...
======================================================================
âœ… Browser: chromium (headless: False)
âœ… Base URL: https://the-internet.herokuapp.com/
======================================================================

ğŸ“ Scenario: Successfully interact with checkboxes
----------------------------------------------------------------------
âœ… New page created for scenario
  âœ“ I navigate to the Herokuapp homepage
  âœ“ I click on the "Checkboxes" link
  âœ“ I check the first checkbox
  âœ“ I uncheck the second checkbox
  âœ“ the first checkbox should be checked
  âœ“ the second checkbox should be unchecked

âœ… Scenario passed: Successfully interact with checkboxes
```

If you see the initialization message, **hooks are working correctly!**

## ğŸ” Understanding the Conversion

### Original Recording Flow

```python
# 1. Setup browser
browser = p.chromium.launch()
page = browser.new_page()

# 2. Navigate and interact
page.goto("https://the-internet.herokuapp.com/")
page.click("text=Checkboxes")
checkbox1.check()
checkbox2.uncheck()

# 3. More navigation
page.goto("https://the-internet.herokuapp.com/")
page.click("text=Challenging DOM")
page.click("a.button:has-text('foo')")
```

### Converted BDD Scenarios

The recording was analyzed and broken into **4 distinct scenarios**:

#### Scenario 1: Checkboxes
```gherkin
Scenario: Successfully interact with checkboxes
  Given I navigate to the Herokuapp homepage
  When I click on the "Checkboxes" link
  And I check the first checkbox
  And I uncheck the second checkbox
  Then the first checkbox should be checked
  And the second checkbox should be unchecked
```

#### Scenario 2: Challenging DOM Buttons
```gherkin
Scenario: Successfully interact with Challenging DOM buttons
  When I click on the "Challenging DOM" link
  Then I should see the Challenging DOM page
  When I click the "foo" button
  And I click the "bar" button
  And I click the "baz" button
  Then all button clicks should be successful
```

#### Scenario 3: Table Actions
```gherkin
Scenario: Successfully interact with table actions
  When I click on the "Challenging DOM" link
  Then I should see the data table with 10 rows
  When I click the "edit" link in row 1
  And I click the "delete" link in row 1
  Then the table actions should be successful
```

#### Scenario 4: End-to-End Flow
```gherkin
Scenario: Complete workflow - Checkboxes and Challenging DOM
  # Combines all actions in a single end-to-end test
```

## ğŸ’¡ Key Learnings from This Example

### 1. environment.py Location Matters

```
âœ… features/environment.py       â† Behave finds it
âŒ steps/environment.py          â† Behave ignores it
âŒ tests/environment.py          â† Behave ignores it
```

### 2. Hooks Create context.page

In `environment.py`:

```python
def before_scenario(context, scenario):
    context.page = context.context.new_page()  # Creates context.page
```

Without this hook running:
- `context.page` is never created
- Step definitions fail with `AttributeError`

### 3. Steps Should Be Reusable

âŒ **Bad** (Specific):
```python
@when('I check the first checkbox on the checkboxes page at index 0')
```

âœ… **Good** (Reusable):
```python
@when('I check the first checkbox')
```

### 4. Use Parameters for Flexibility

```python
@when('I click the "{button_name}" button')
def step_impl(context, button_name):
    # Works for any button: foo, bar, baz
```

### 5. Scenario Outlines Reduce Duplication

Instead of 3 similar scenarios:

```gherkin
Scenario Outline: Interact with different buttons
  When I click the "<button_name>" button

  Examples:
    | button_name |
    | foo         |
    | bar         |
    | baz         |
```

## ğŸ”§ Troubleshooting

### Error: `AttributeError: 'Context' object has no attribute 'page'`

**Cause**: `environment.py` is not in the correct location

**Fix**:
```bash
# Check where environment.py is located
find . -name "environment.py"

# It should be at: features/environment.py
# If it's elsewhere, move it:
mv steps/environment.py features/
```

### Error: Steps show as "undefined"

**Cause**: Step definitions are not in the correct location

**Fix**:
```bash
# Step definitions must be in features/steps/
mkdir -p features/steps
mv your_steps.py features/steps/
```

### No initialization messages appear

**Cause**: Hooks are not running (environment.py not found)

**Fix**:
```bash
# Ensure environment.py is at features/environment.py
ls -la features/environment.py

# Verify it has the hook functions
grep "def before_" features/environment.py
```

## ğŸ“š Related Documentation

- **[../../BEHAVE_TROUBLESHOOTING_GUIDE.md](../../BEHAVE_TROUBLESHOOTING_GUIDE.md)** - Complete troubleshooting guide
- **[../../PLAYWRIGHT_TO_BDD_CONVERSION_GUIDE.md](../../PLAYWRIGHT_TO_BDD_CONVERSION_GUIDE.md)** - Detailed conversion guide

## ğŸ¯ Next Steps

1. **Study the examples** - Compare the recording vs. BDD version
2. **Run the tests** - See the difference in output and clarity
3. **Convert your own recordings** - Apply the same process
4. **Follow the guides** - Use the troubleshooting and conversion guides
5. **Practice** - The more you convert, the better you'll get!

## ğŸ“ Summary

This example demonstrates:

âœ… **Correct file structure** - environment.py in features/
âœ… **Proper BDD conversion** - Recording â†’ Gherkin scenarios
âœ… **Reusable step definitions** - Generic, parameterized steps
âœ… **Page Object pattern** - Maintainable test code
âœ… **Complete working example** - Ready to run and learn from

Remember: The goal is **readable**, **maintainable**, and **valuable** tests!
